# ğŸ“Š Aè‚¡è‚¡ç¥¨åŸºæœ¬é¢æ•°æ®ç¼“å­˜ç³»ç»Ÿä½¿ç”¨æŒ‡å—

## ğŸ¯ ç³»ç»Ÿæ¦‚è¿°

æœ¬ç³»ç»Ÿå®ç°äº†**å®Œæ•´çš„Aè‚¡è‚¡ç¥¨åŸºæœ¬é¢æ•°æ®ç¼“å­˜åŠŸèƒ½**ï¼Œæ”¯æŒï¼š
- âœ… **ç¼“å­˜æ‰€æœ‰Aè‚¡è‚¡ç¥¨**çš„å®Œæ•´åŸºæœ¬é¢æ•°æ®
- âœ… **å®šæœŸè‡ªåŠ¨æ›´æ–°**ï¼ˆé»˜è®¤30å¤©ï¼‰
- âœ… **åŒ…å«README.mdè¦æ±‚çš„æ‰€æœ‰æ•°æ®å­—æ®µ**
- âœ… **æ”¯æŒåˆ†æ‰¹å¤„ç†å’Œæ–­ç‚¹ç»­ä¼ **
- âœ… **æ”¯æŒæ•°é‡é™åˆ¶å’Œçµæ´»é…ç½®**

## ğŸ“‹ æ•°æ®å­—æ®µè¯´æ˜

### ğŸ¢ å…¬å¸åŸºæœ¬ä¿¡æ¯
| å­—æ®µ | è¯´æ˜ | ç¤ºä¾‹ |
|------|------|------|
| `code` | è‚¡ç¥¨ä»£ç  | 000001 |
| `name` | è‚¡ç¥¨åç§° | å¹³å®‰é“¶è¡Œ |
| `list_date` | ä¸Šå¸‚æ—¥æœŸ | 1991-04-03 |
| `exchange` | äº¤æ˜“æ‰€ | æ·±åœ³è¯åˆ¸äº¤æ˜“æ‰€ |
| `industry` | æ‰€å±è¡Œä¸š | é“¶è¡Œä¸š |
| `sector` | æ‰€å±åœ°åŒº | å¹¿ä¸œçœ |
| `company_name` | å…¬å¸åç§° | å¹³å®‰é“¶è¡Œè‚¡ä»½æœ‰é™å…¬å¸ |
| `company_industry` | å…¬å¸è¡Œä¸š | è´§å¸é‡‘èæœåŠ¡ |
| `company_region` | å…¬å¸åœ°åŒº | å¹¿ä¸œçœæ·±åœ³å¸‚ |
| `ceo` | æ€»ç»ç† | èƒ¡è·ƒé£ |
| `chairman` | è‘£äº‹é•¿ | è°¢æ°¸æ— |
| `secretary` | è‘£ç§˜ | å‘¨å¼º |
| `employees` | å‘˜å·¥äººæ•° | 36000 |

### ğŸ“Š è´¢åŠ¡ä¸‰è¡¨æ•°æ®
#### èµ„äº§è´Ÿå€ºè¡¨
- `total_assets`: æ€»èµ„äº§(ä¸‡å…ƒ)
- `total_liabilities`: æ€»è´Ÿå€º(ä¸‡å…ƒ)
- `total_equity`: è‚¡ä¸œæƒç›Š(ä¸‡å…ƒ)
- `current_assets`: æµåŠ¨èµ„äº§(ä¸‡å…ƒ)
- `current_liabilities`: æµåŠ¨è´Ÿå€º(ä¸‡å…ƒ)

#### åˆ©æ¶¦è¡¨
- `revenue`: è¥ä¸šæ”¶å…¥(ä¸‡å…ƒ)
- `operating_profit`: è¥ä¸šåˆ©æ¶¦(ä¸‡å…ƒ)
- `net_profit`: å‡€åˆ©æ¶¦(ä¸‡å…ƒ)
- `gross_profit`: æ¯›åˆ©æ¶¦(ä¸‡å…ƒ)

#### ç°é‡‘æµé‡è¡¨
- `operating_cash_flow`: ç»è¥ç°é‡‘æµ(ä¸‡å…ƒ)
- `investing_cash_flow`: æŠ•èµ„ç°é‡‘æµ(ä¸‡å…ƒ)
- `financing_cash_flow`: ç­¹èµ„ç°é‡‘æµ(ä¸‡å…ƒ)
- `free_cash_flow`: è‡ªç”±ç°é‡‘æµ(ä¸‡å…ƒ)

### ğŸ“ˆ å…³é”®è´¢åŠ¡æŒ‡æ ‡
| æŒ‡æ ‡ | å­—æ®µ | å•ä½ |
|------|------|------|
| æ¯è‚¡æ”¶ç›Š | `eps` | å…ƒ |
| å¸‚ç›ˆç‡(é™) | `pe_static` | å€ |
| å¸‚ç›ˆç‡(TTM) | `pe_ttm` | å€ |
| å¸‚å‡€ç‡ | `pb` | å€ |
| å‡€èµ„äº§æ”¶ç›Šç‡ | `roe` | % |
| æ€»èµ„äº§æ”¶ç›Šç‡ | `roa` | % |
| æ¯›åˆ©ç‡ | `gross_margin` | % |
| å‡€åˆ©ç‡ | `net_margin` | % |
| èµ„äº§è´Ÿå€ºç‡ | `debt_ratio` | % |
| æµåŠ¨æ¯”ç‡ | `current_ratio` | å€ |
| é€ŸåŠ¨æ¯”ç‡ | `quick_ratio` | å€ |
| è¥æ”¶å¢é•¿ç‡ | `revenue_growth` | % |
| å‡€åˆ©æ¶¦å¢é•¿ç‡ | `profit_growth` | % |
| æ€»èµ„äº§å¢é•¿ç‡ | `assets_growth` | % |

### ğŸ’° å¸‚åœºæ•°æ®
- `current_price`: å½“å‰ä»·æ ¼
- `market_cap`: æ€»å¸‚å€¼(äº¿å…ƒ)
- `dividend_yield`: è‚¡æ¯ç‡(%)
- `dividend_per_share`: æ¯è‚¡è‚¡åˆ©(å…ƒ)

## ğŸš€ ä½¿ç”¨æ–¹æ³•

### 1ï¸âƒ£ å¿«é€Ÿå¼€å§‹
```bash
cd /Users/dora/Documents/JavaDemos/HelloStock/stock_screeners
python3 stock_fundamentals_cache.py
```

### 2ï¸âƒ£ é…ç½®ç¯å¢ƒå˜é‡
```bash
# è®¾ç½®æ›´æ–°å‘¨æœŸï¼ˆå¤©ï¼‰
export UPDATE_INTERVAL_DAYS=30

# è®¾ç½®åˆ†æ‰¹å¤„ç†å¤§å°
export BATCH_SIZE=100

# è®¾ç½®æœ€å¤§å¤„ç†æ•°é‡ï¼ˆ0è¡¨ç¤ºå¤„ç†æ‰€æœ‰ï¼‰
export MAX_STOCKS=1000

# è¿è¡Œç¨‹åº
python3 stock_fundamentals_cache.py
```

### 3ï¸âƒ£ å‘½ä»¤è¡Œå‚æ•°
```bash
# å…¨é‡æ›´æ–°æ‰€æœ‰è‚¡ç¥¨
python3 stock_fundamentals_cache.py

# æµ‹è¯•100åªè‚¡ç¥¨
export MAX_STOCKS=100
python3 stock_fundamentals_cache.py

# å¤§æ‰¹æ¬¡å¿«é€Ÿå¤„ç†
export BATCH_SIZE=200
export MAX_STOCKS=500
python3 stock_fundamentals_cache.py
```

## ğŸ“ ç”Ÿæˆæ–‡ä»¶

### ç¼“å­˜æ–‡ä»¶
```
cache/
â”œâ”€â”€ stockA_fundamentals.csv      # å®Œæ•´åŸºæœ¬é¢æ•°æ®
â”œâ”€â”€ stockA_list.csv             # Aè‚¡è‚¡ç¥¨åˆ—è¡¨
â”œâ”€â”€ update_log.json             # æ›´æ–°æ—¥å¿—
â””â”€â”€ fundamentals_update_checkpoint.json  # æ–­ç‚¹ç»­ä¼ æ–‡ä»¶
```

### æ•°æ®æ ¼å¼ç¤ºä¾‹
```csv
code,name,list_date,exchange,industry,total_assets,total_liabilities,total_equity,revenue,net_profit,eps,pe_ttm,pb,roe,debt_ratio,gross_margin,current_price,market_cap,update_time
000001,å¹³å®‰é“¶è¡Œ,1991-04-03,æ·±äº¤æ‰€,é“¶è¡Œä¸š,450000000,400000000,50000000,18000000,4500000,2.25,8.5,0.8,12.5,88.9,35.2,18.5,3500,2024-01-15T10:30:00
000002,ä¸‡ç§‘A,1991-01-29,æ·±äº¤æ‰€,æˆ¿åœ°äº§,1800000000,1300000000,500000000,40000000,2500000,2.1,12.3,0.9,8.5,72.2,25.8,25.8,2800,2024-01-15T10:30:00
```

## âš™ï¸ é«˜çº§é…ç½®

### è‡ªå®šä¹‰æ›´æ–°å‘¨æœŸ
```python
# åœ¨ä»£ç ä¸­è®¾ç½®
from stock_fundamentals_cache import StockFundamentalsCache

cache = StockFundamentalsCache()

# è®¾ç½®æ›´æ–°å‘¨æœŸä¸º7å¤©
cache.UPDATE_INTERVAL_DAYS = 7

# æ‰§è¡Œæ›´æ–°
cache.update_fundamentals_cache(batch_size=50, max_stocks=1000)
```

### æ•°æ®éªŒè¯
```python
# æ£€æŸ¥ç¼“å­˜ä¿¡æ¯
info = cache.get_cache_info()
print(json.dumps(info, indent=2, ensure_ascii=False))

# åŠ è½½ç¼“å­˜æ•°æ®
df = cache.load_fundamentals_cache()
print(f"æ•°æ®æ¦‚è§ˆ: {len(df)}åªè‚¡ç¥¨, {len(df.columns)}ä¸ªå­—æ®µ")
```

## ğŸ”§ æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

#### 1. ç½‘ç»œè¿æ¥é—®é¢˜
```bash
# æ£€æŸ¥ç½‘ç»œè¿æ¥
ping finance.sina.com.cn

# ä½¿ç”¨ä»£ç†ï¼ˆå¦‚æœéœ€è¦ï¼‰
export HTTP_PROXY=http://proxy.company.com:8080
export HTTPS_PROXY=http://proxy.company.com:8080
```

#### 2. å†…å­˜ä¸è¶³
```bash
# å‡å°‘æ‰¹æ¬¡å¤§å°
export BATCH_SIZE=20
python3 stock_fundamentals_cache.py
```

#### 3. æ–­ç‚¹ç»­ä¼ 
```bash
# æŸ¥çœ‹æ–­ç‚¹ä¿¡æ¯
cat cache/fundamentals_update_checkpoint.json

# æ¸…ç†æ–­ç‚¹é‡æ–°å¼€å§‹
rm cache/fundamentals_update_checkpoint.json
python3 stock_fundamentals_cache.py
```

### æ—¥å¿—ç›‘æ§
```bash
# å®æ—¶æŸ¥çœ‹è¿›åº¦
tail -f cache/update_log.json

# æ£€æŸ¥æ•°æ®å®Œæ•´æ€§
python3 -c "
import pandas as pd
df = pd.read_csv('cache/stockA_fundamentals.csv')
print(f'æ€»è‚¡ç¥¨æ•°: {len(df)}')
print(f'æ•°æ®å®Œæ•´æ€§: {df.isnull().sum()}')
"
```

## ğŸ“Š æ€§èƒ½ä¼˜åŒ–å»ºè®®

### ç½‘ç»œç¯å¢ƒè‰¯å¥½æ—¶
- ä½¿ç”¨è¾ƒå¤§çš„`BATCH_SIZE`ï¼ˆ100-200ï¼‰
- è®¾ç½®`MAX_STOCKS=0`å¤„ç†æ‰€æœ‰è‚¡ç¥¨

### ç½‘ç»œç¯å¢ƒä¸€èˆ¬æ—¶
- ä½¿ç”¨è¾ƒå°çš„`BATCH_SIZE`ï¼ˆ20-50ï¼‰
- è®¾ç½®`MAX_STOCKS=500`å…ˆæµ‹è¯•å°è§„æ¨¡

### å¼€å‘æµ‹è¯•æ—¶
- è®¾ç½®`MAX_STOCKS=100`å¿«é€ŸéªŒè¯
- ä½¿ç”¨`BATCH_SIZE=10`è§‚å¯Ÿè¯¦ç»†è¿‡ç¨‹

## ğŸ¯ å®é™…ä½¿ç”¨åœºæ™¯

| åœºæ™¯ | æ¨èé…ç½® | é¢„æœŸæ—¶é—´ |
|------|----------|----------|
| **é¦–æ¬¡å…¨é‡æ›´æ–°** | `BATCH_SIZE=100 MAX_STOCKS=0` | 2-3å°æ—¶ |
| **å®šæœŸæ›´æ–°** | `BATCH_SIZE=50 MAX_STOCKS=0` | 1-2å°æ—¶ |
| **ç­–ç•¥éªŒè¯** | `BATCH_SIZE=100 MAX_STOCKS=1000` | 30åˆ†é’Ÿ |
| **åŠŸèƒ½æµ‹è¯•** | `BATCH_SIZE=10 MAX_STOCKS=50` | 5åˆ†é’Ÿ |

## ğŸ”„ ä¸é€‰è‚¡ç³»ç»Ÿé›†æˆ

### åœ¨é€‰è‚¡ç¨‹åºä¸­ä½¿ç”¨ç¼“å­˜
```python
# åœ¨stock_selector.pyä¸­é›†æˆ
from stock_fundamentals_cache import StockFundamentalsCache

cache = StockFundamentalsCache()

# ç¡®ä¿ç¼“å­˜æ˜¯æœ€æ–°çš„
if cache.should_update_cache():
    cache.update_fundamentals_cache()

# åŠ è½½ç¼“å­˜æ•°æ®ç”¨äºé€‰è‚¡
df = cache.load_fundamentals_cache()
# ä½¿ç”¨dfè¿›è¡Œé€‰è‚¡åˆ†æ...
```

## ğŸ“ æŠ€æœ¯æ”¯æŒ

å¦‚æœ‰é—®é¢˜ï¼Œè¯·æ£€æŸ¥ï¼š
1. âœ… ç½‘ç»œè¿æ¥æ˜¯å¦æ­£å¸¸
2. âœ… akshareåº“æ˜¯å¦æœ€æ–°
3. âœ… ç£ç›˜ç©ºé—´æ˜¯å¦å……è¶³
4. âœ… æ–‡ä»¶æƒé™æ˜¯å¦æ­£ç¡®

ç³»ç»Ÿå®Œå…¨æŒ‰ç…§README.mdè¦æ±‚å®ç°ï¼ŒåŒ…å«æ‰€æœ‰æŒ‡å®šçš„æ•°æ®å­—æ®µå’Œå®šæœŸæ›´æ–°æœºåˆ¶ï¼